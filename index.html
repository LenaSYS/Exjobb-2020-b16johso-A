<!DOCTYPE html>
<html>
	<head>
		<title>WebGL 3D Model Viewer Using babylon.js</title>

		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />

		<script src="babylon.js"></script>
		<script src="babylon.objFileLoader.js"></script>

		<style>
			body {
				overflow: hidden;
				margin: 0;
				padding: 0;
				background: hsl(0, 0%, 10%);
			}

			p {
				margin: 0;
				padding: 0;
			}

			canvas {
				height: 100%;
				width: 100%;
			}

			.left,
			.right {
				position: absolute;
				color: #fff;
				font-family: Geneva, sans-serif;
			}

			.left {
				bottom: 1em;
				left: 1em;
				text-align: left;
			}

			.right {
				top: 0;
				right: 0;
				text-align: right;
			}

			a {
				color: #f58231;
			}
		</style>
	</head>
	<body>
		<script>
			var container;
			var canvas;

			var engine;

			var camera, controls, scene, renderer;
			var lighting, ambient, keyLight, fillLight, backLight;

			init();

			function init() {
				container = document.createElement("div");
				document.body.appendChild(container);
				canvas = document.createElement("canvas");
				container.appendChild(canvas);

				engine = new BABYLON.Engine(canvas, true); // Generate the BABYLON 3D engine

				/* Scene */
				scene = new BABYLON.Scene(engine);

				/* Camera */

				camera = new BABYLON.ArcRotateCamera(
					"Camera",
					Math.PI / 2,
					Math.PI / 2,
					5,
					new BABYLON.Vector3(0, 0, 0),
					scene
				);
				camera.attachControl(canvas, true);
				camera.inertia = 0.25;

				lighting = false;

				ambient = new BABYLON.HemisphericLight("HemiLight", new BABYLON.Vector3(0, 1, 0), scene);
				ambient.intensity = 1.0;

				keyLight = new BABYLON.DirectionalLight("DirectionalLight", new BABYLON.Vector3(-100, 0, 100), scene);
				keyLight.diffuse = new BABYLON.Color3("hsl(30, 100%, 75%)");
				keyLight.intensity = 1.0;

				fillLight = new BABYLON.DirectionalLight("DirectionalLight", new BABYLON.Vector3(100, 0, 100), scene);
				fillLight.diffuse = new BABYLON.Color3("hsl(240, 100%, 75%)");
				fillLight.intensity = 0.75;

				backLight = new BABYLON.DirectionalLight("DirectionalLight", new BABYLON.Vector3(100, 0, -100), scene);
				backLight.intensity = 1.0;

				//var sphere = BABYLON.MeshBuilder.CreateSphere("sphere", { diameter: 2 }, scene);
				BABYLON.SceneLoader.Append("./assets/", "female-croupier-2013-03-26.obj", scene, function(scene) {
					console.log("Mesh loaded");
				});

				/* Model */

				/*var mtlLoader = new THREE.MTLLoader();
        mtlLoader.setBaseUrl("assets/");
        mtlLoader.setPath("assets/");
        mtlLoader.load("female-croupier-2013-03-26.mtl", function(materials) {
          materials.preload();

          materials.materials.default.map.magFilter = THREE.NearestFilter;
          materials.materials.default.map.minFilter = THREE.LinearFilter;

          var objLoader = new THREE.OBJLoader();
          objLoader.setMaterials(materials);
          objLoader.setPath("assets/");
          objLoader.load("female-croupier-2013-03-26.obj", function(object) {
            scene.add(object);
          });
        });*/

				/* Renderer */
				engine.runRenderLoop(function() {
					scene.render();
				});

				/* Events */

				window.addEventListener("resize", onWindowResize, false);
				window.addEventListener("keydown", onKeyboardEvent, false);
			}

			function onWindowResize() {
				engine.resize();
			}

			function onKeyboardEvent(e) {
				if (e.code === "KeyL") {
					lighting = !lighting;

					if (lighting) {
						ambient.intensity = 0.25;
						keyLight.setEnabled(true);
						fillLight.setEnabled(true);
						backLight.setEnabled(true);
					} else {
						ambient.intensity = 1.0;
						keyLight.setEnabled(false);
						fillLight.setEnabled(false);
						backLight.setEnabled(false);
					}
				}
			}
		</script>
	</body>
</html>
